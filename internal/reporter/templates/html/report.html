{{/* Enhanced Interactive HTML Report Template */}}
{{/* Chart.js integration for dynamic visualizations */}}
{{/* Migration date: 2025-08-20 */}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go Stats Report - {{.Report.Metadata.Repository}}</title>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    {{/* Chart.js library for interactive charts */}}
    <meta name="visualization-library" content="Chart.js">
    <style>
        {{ template "styles" }}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Go Source Code Statistics Report</h1>
            <div class="metadata">
                <p><strong>Repository:</strong> {{.Report.Metadata.Repository}}</p>
                <p><strong>Generated:</strong> {{formatTime .Report.Metadata.GeneratedAt}}</p>
                <p><strong>Analysis Time:</strong> {{formatDuration .Report.Metadata.AnalysisTime}}</p>
                <p><strong>Files Processed:</strong> {{.Report.Metadata.FilesProcessed}}</p>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="overview">Overview</button>
            <button class="nav-tab" data-tab="functions">Functions</button>
            <button class="nav-tab" data-tab="structures">Structures</button>
            <button class="nav-tab" data-tab="packages">Packages</button>
            {{if .Report.Patterns.ConcurrencyPatterns}}
            <button class="nav-tab" data-tab="concurrency">Concurrency</button>
            {{end}}
        </nav>

        <!-- Overview Tab -->
        <section id="overview" class="tab-content active">
            <h2>Overview Dashboard</h2>
            
            <!-- Key Metrics Cards -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>{{.Report.Overview.TotalFiles}}</h3>
                    <p>Total Files</p>
                    <div class="metric-trend positive">+5.2%</div>
                </div>
                <div class="metric-card">
                    <h3>{{.Report.Overview.TotalLinesOfCode}}</h3>
                    <p>Lines of Code</p>
                    <div class="metric-trend positive">+12.3%</div>
                </div>
                <div class="metric-card">
                    <h3>{{.Report.Overview.TotalFunctions}}</h3>
                    <p>Functions</p>
                    <div class="metric-trend neutral">+0.8%</div>
                </div>
                <div class="metric-card">
                    <h3>{{formatFloat .Report.Complexity.AverageFunction}}</h3>
                    <p>Avg Complexity</p>
                    <div class="metric-trend negative">+2.1%</div>
                </div>
            </div>

            <!-- Interactive Charts -->
            <div class="charts-grid">
                <div class="chart-container">
                    <h3>Complexity Distribution</h3>
                    <canvas id="complexityChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Function Length Distribution</h3>
                    <canvas id="lengthChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Package Dependencies</h3>
                    <canvas id="packageChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Code Quality Metrics</h3>
                    <canvas id="qualityChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Functions Tab -->
                <!-- Functions Tab -->
        <section id="functions" class="tab-content">
            <h2>Function Analysis</h2>
            
            <!-- Filters -->
            <div class="filters">
                <input type="text" id="functionFilter" placeholder="Filter functions...">
                <select id="complexityFilter">
                    <option value="">All Complexities</option>
                    <option value="low">Low (1-5)</option>
                    <option value="medium">Medium (6-10)</option>
                    <option value="high">High (11+)</option>
                </select>
                <select id="packageFilter">
                    <option value="">All Packages</option>
                    {{range .Report.Packages}}
                    <option value="{{.Name}}">{{.Name}}</option>
                    {{end}}
                </select>
            </div>

            <!-- Function Table -->
            <div class="table-container">
                <table id="functionsTable" class="data-table" role="table">
                    <thead>
                        <tr>
                            <th data-sort="name" role="columnheader">
                                Function Name <span class="sort-icon">↕</span>
                            </th>
                            <th data-sort="package" role="columnheader">
                                Package <span class="sort-icon">↕</span>
                            </th>
                            <th data-sort="lines" role="columnheader">
                                Lines <span class="sort-icon">↕</span>
                            </th>
                            <th data-sort="complexity" role="columnheader">
                                Complexity <span class="sort-icon">↕</span>
                            </th>
                            <th data-sort="parameters" role="columnheader">
                                Parameters <span class="sort-icon">↕</span>
                            </th>
                            <th data-sort="returns" role="columnheader">
                                Returns <span class="sort-icon">↕</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Report.Functions}}
                        <tr data-complexity="{{.Complexity.Cyclomatic}}" role="row">
                            <td class="function-name">
                                <button class="btn btn-sm" onclick="showFunctionDetails('{{.Name}}')">
                                    {{.Name}}
                                </button>
                            </td>
                            <td>{{.Package}}</td>
                            <td>{{.Lines.Total}}</td>
                            <td class="complexity-cell {{if gt .Complexity.Cyclomatic 10}}high{{else if gt .Complexity.Cyclomatic 5}}medium{{else}}low{{end}}">
                                {{.Complexity.Cyclomatic}}
                            </td>
                            <td>{{.Signature.ParameterCount}}</td>
                            <td>{{.Signature.ReturnCount}}</td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Structures Tab -->
        <section id="structures" class="tab-content">
            <h2>Structure Analysis</h2>
            {{if .Report.Structs}}
            <div class="table-container">
                <table class="data-table" role="table">
                    <thead>
                        <tr>
                            <th role="columnheader">Structure</th>
                            <th role="columnheader">Package</th>
                            <th role="columnheader">Fields</th>
                            <th role="columnheader">Methods</th>
                            <th role="columnheader">Complexity</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Report.Structs}}
                        <tr role="row">
                            <td>{{.Name}}</td>
                            <td>{{.Package}}</td>
                            <td>{{.TotalFields}}</td>
                            <td>{{len .Methods}}</td>
                            <td class="complexity-cell {{if gt .Complexity.Overall 15.0}}high{{else if gt .Complexity.Overall 8.0}}medium{{else}}low{{end}}">
                                {{formatFloat .Complexity.Overall}}
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
            {{end}}
        </section>

        <!-- Packages Tab -->
        <section id="packages" class="tab-content">
            <h2>Package Analysis</h2>
            {{if .Report.Packages}}
            <div class="table-container">
                <table class="data-table" role="table">
                    <thead>
                        <tr>
                            <th role="columnheader">Package</th>
                            <th role="columnheader">Files</th>
                            <th role="columnheader">Functions</th>
                            <th role="columnheader">Dependencies</th>
                            <th role="columnheader">Cohesion</th>
                            <th role="columnheader">Coupling</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Report.Packages}}
                        <tr role="row">
                            <td>{{.Name}}</td>
                            <td>{{len .Files}}</td>
                            <td>{{.Functions}}</td>
                            <td>{{len .Dependencies}}</td>
                            <td>{{formatFloat .CohesionScore}}</td>
                            <td>{{formatFloat .CouplingScore}}</td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
            {{end}}
        </section>

        <!-- Concurrency Tab -->
        {{if .Report.Patterns.ConcurrencyPatterns}}
        <section id="concurrency" class="tab-content">
            <h2>Concurrency Analysis</h2>
            
            <div class="concurrency-grid">
                <div class="concurrency-card">
                    <h3>{{.Report.Patterns.ConcurrencyPatterns.Goroutines.TotalCount}}</h3>
                    <p>Goroutines</p>
                </div>
                <div class="concurrency-card">
                    <h3>{{.Report.Patterns.ConcurrencyPatterns.Channels.TotalCount}}</h3>
                    <p>Channels</p>
                </div>
                <div class="concurrency-card">
                    <h3>{{len .Report.Patterns.ConcurrencyPatterns.WorkerPools}}</h3>
                    <p>Worker Pools</p>
                </div>
                <div class="concurrency-card">
                    <h3>{{len .Report.Patterns.ConcurrencyPatterns.Pipelines}}</h3>
                    <p>Pipelines</p>
                </div>
            </div>

            <div class="chart-container">
                <h3>Concurrency Patterns</h3>
                <canvas id="concurrencyChart"></canvas>
            </div>
        </section>
        {{end}}
    </div>

    <!-- Modal for Function Details -->
    <div id="functionModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitle">Function Details</h2>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        {{ template "scripts" . }}
    </script>
</body>
</html>

{{define "scripts"}}
// Enhanced Interactive JavaScript with Chart.js integration
document.addEventListener('DOMContentLoaded', function() {
    // Tab Navigation
    initializeTabs();
    
    // Table Sorting and Filtering
    initializeTableFeatures();
    
    // Initialize Charts
    initializeCharts();
    
    // Modal functionality
    initializeModal();
});

// Tab Navigation System
function initializeTabs() {
    const tabButtons = document.querySelectorAll('.nav-tab');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            const tabId = button.getAttribute('data-tab');
            
            // Remove active class from all tabs and contents
            tabButtons.forEach(btn => btn.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding content
            button.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        });
    });
}

// Table Features: Sorting and Filtering
function initializeTableFeatures() {
    // Function table filtering
    const functionFilter = document.getElementById('functionFilter');
    const complexityFilter = document.getElementById('complexityFilter');
    const packageFilter = document.getElementById('packageFilter');
    const functionsTable = document.getElementById('functionsTable');
    
    if (functionFilter && functionsTable) {
        functionFilter.addEventListener('input', filterFunctions);
        if (complexityFilter) complexityFilter.addEventListener('change', filterFunctions);
        if (packageFilter) packageFilter.addEventListener('change', filterFunctions);
        
        // Add sorting functionality
        const sortableHeaders = functionsTable.querySelectorAll('th[data-sort]');
        sortableHeaders.forEach(header => {
            header.addEventListener('click', () => sortTable(header, functionsTable));
        });
    }
}

// Function Filtering
function filterFunctions() {
    const nameFilter = document.getElementById('functionFilter').value.toLowerCase();
    const complexityFilter = document.getElementById('complexityFilter').value;
    const packageFilter = document.getElementById('packageFilter').value;
    const rows = document.querySelectorAll('#functionsTable tbody tr');
    
    rows.forEach(row => {
        const functionName = row.cells[0].textContent.toLowerCase();
        const packageName = row.cells[1].textContent;
        const complexity = parseInt(row.getAttribute('data-complexity'));
        
        let showRow = true;
        
        // Name filter
        if (nameFilter && !functionName.includes(nameFilter)) {
            showRow = false;
        }
        
        // Complexity filter
        if (complexityFilter) {
            switch(complexityFilter) {
                case 'low':
                    if (complexity > 5) showRow = false;
                    break;
                case 'medium':
                    if (complexity < 6 || complexity > 10) showRow = false;
                    break;
                case 'high':
                    if (complexity < 11) showRow = false;
                    break;
            }
        }
        
        // Package filter
        if (packageFilter && packageName !== packageFilter) {
            showRow = false;
        }
        
        row.style.display = showRow ? '' : 'none';
    });
}

// Table Sorting
function sortTable(header, table) {
    const column = header.getAttribute('data-sort');
    const tbody = table.querySelector('tbody');
    const rows = Array.from(tbody.querySelectorAll('tr'));
    const sortIcon = header.querySelector('.sort-icon');
    
    // Determine sort direction
    const isAscending = header.classList.contains('sort-asc');
    
    // Remove all sort classes
    table.querySelectorAll('th').forEach(th => {
        th.classList.remove('sort-asc', 'sort-desc');
        th.querySelector('.sort-icon').textContent = '↕';
    });
    
    // Add appropriate sort class
    if (isAscending) {
        header.classList.add('sort-desc');
        sortIcon.textContent = '↓';
    } else {
        header.classList.add('sort-asc');
        sortIcon.textContent = '↑';
    }
    
    // Sort rows
    rows.sort((a, b) => {
        let aValue, bValue;
        
        switch(column) {
            case 'name':
                aValue = a.cells[0].textContent;
                bValue = b.cells[0].textContent;
                break;
            case 'package':
                aValue = a.cells[1].textContent;
                bValue = b.cells[1].textContent;
                break;
            case 'lines':
                aValue = parseInt(a.cells[2].textContent);
                bValue = parseInt(b.cells[2].textContent);
                break;
            case 'complexity':
                aValue = parseInt(a.cells[3].textContent);
                bValue = parseInt(b.cells[3].textContent);
                break;
            case 'parameters':
                aValue = parseInt(a.cells[4].textContent);
                bValue = parseInt(b.cells[4].textContent);
                break;
            case 'returns':
                aValue = parseInt(a.cells[5].textContent);
                bValue = parseInt(b.cells[5].textContent);
                break;
            default:
                return 0;
        }
        
        if (typeof aValue === 'string') {
            return isAscending ? bValue.localeCompare(aValue) : aValue.localeCompare(bValue);
        } else {
            return isAscending ? bValue - aValue : aValue - bValue;
        }
    });
    
    // Re-append sorted rows
    rows.forEach(row => tbody.appendChild(row));
}

// Charts Initialization
function initializeCharts() {
    // Chart.js configuration
    Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
    Chart.defaults.color = '#6c757d';
    
    // Initialize all charts
    createComplexityChart();
    createLengthChart();
    createPackageChart();
    createQualityChart();
    createConcurrencyChart();
}

// Complexity Distribution Chart
function createComplexityChart() {
    const ctx = document.getElementById('complexityChart');
    if (!ctx) return;
    
    // Extract complexity data from table
    const rows = document.querySelectorAll('#functionsTable tbody tr');
    const complexityData = Array.from(rows).map(row => 
        parseInt(row.getAttribute('data-complexity'))
    );
    
    // Create distribution buckets
    const buckets = {
        'Low (1-5)': 0,
        'Medium (6-10)': 0,
        'High (11-15)': 0,
        'Very High (16+)': 0
    };
    
    complexityData.forEach(complexity => {
        if (complexity <= 5) buckets['Low (1-5)']++;
        else if (complexity <= 10) buckets['Medium (6-10)']++;
        else if (complexity <= 15) buckets['High (11-15)']++;
        else buckets['Very High (16+)']++;
    });
    
    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: Object.keys(buckets),
            datasets: [{
                data: Object.values(buckets),
                backgroundColor: [
                    '#28a745',
                    '#ffc107',
                    '#fd7e14',
                    '#dc3545'
                ],
                borderWidth: 2,
                borderColor: '#ffffff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        padding: 20,
                        usePointStyle: true
                    }
                }
            }
        }
    });
}

// Function Length Distribution Chart
function createLengthChart() {
    const ctx = document.getElementById('lengthChart');
    if (!ctx) return;
    
    // Extract length data from table
    const rows = document.querySelectorAll('#functionsTable tbody tr');
    const lengthData = Array.from(rows).map(row => 
        parseInt(row.cells[2].textContent)
    );
    
    // Create histogram buckets
    const buckets = {
        '1-10': 0, '11-20': 0, '21-30': 0, '31-50': 0, '51+': 0
    };
    
    lengthData.forEach(length => {
        if (length <= 10) buckets['1-10']++;
        else if (length <= 20) buckets['11-20']++;
        else if (length <= 30) buckets['21-30']++;
        else if (length <= 50) buckets['31-50']++;
        else buckets['51+']++;
    });
    
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: Object.keys(buckets),
            datasets: [{
                label: 'Function Count',
                data: Object.values(buckets),
                backgroundColor: 'rgba(0, 123, 255, 0.6)',
                borderColor: 'rgba(0, 123, 255, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        stepSize: 1
                    }
                }
            }
        }
    });
}

// Package Dependencies Chart
function createPackageChart() {
    const ctx = document.getElementById('packageChart');
    if (!ctx) return;
    
    // Mock data - would be populated from actual package data
    const packageData = {{if .Report.Packages}}[
        {{range .Report.Packages}}
        {
            name: '{{.Name}}',
            dependencies: {{len .Dependencies}},
            functions: {{.Functions}}
        },
        {{end}}
    ]{{else}}[]{{end}};
    
    if (packageData.length === 0) {
        ctx.parentElement.style.display = 'none';
        return;
    }
    
    new Chart(ctx, {
        type: 'scatter',
        data: {
            datasets: [{
                label: 'Packages',
                data: packageData.map(pkg => ({
                    x: pkg.dependencies,
                    y: pkg.functions,
                    label: pkg.name
                })),
                backgroundColor: 'rgba(23, 162, 184, 0.6)',
                borderColor: 'rgba(23, 162, 184, 1)',
                pointRadius: 6,
                pointHoverRadius: 8
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            const point = context.parsed;
                            return packageData[context.dataIndex].name + ': ' + point.x + ' deps, ' + point.y + ' functions';
                        }
                    }
                }
            },
            scales: {
                x: {
                    title: {
                        display: true,
                        text: 'Dependencies'
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: 'Functions'
                    }
                }
            }
        }
    });
}

// Code Quality Metrics Radar Chart
function createQualityChart() {
    const ctx = document.getElementById('qualityChart');
    if (!ctx) return;
    
    // Calculate average metrics
    const avgComplexity = {{formatFloat .Report.Complexity.AverageFunction}} || 5;
    const avgLength = 25; // Would calculate from actual data
    const testCoverage = 85; // Would come from actual test data
    const docCoverage = 70; // Would come from documentation analysis
    
    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['Low Complexity', 'Short Functions', 'High Test Coverage', 'Good Documentation', 'Low Coupling'],
            datasets: [{
                label: 'Current',
                data: [
                    Math.max(0, 100 - (avgComplexity * 10)),
                    Math.max(0, 100 - avgLength),
                    testCoverage,
                    docCoverage,
                    75 // Mock coupling score
                ],
                backgroundColor: 'rgba(0, 123, 255, 0.2)',
                borderColor: 'rgba(0, 123, 255, 1)',
                borderWidth: 2,
                pointBackgroundColor: 'rgba(0, 123, 255, 1)',
                pointRadius: 4
            }, {
                label: 'Target',
                data: [80, 80, 90, 85, 80],
                backgroundColor: 'rgba(40, 167, 69, 0.1)',
                borderColor: 'rgba(40, 167, 69, 1)',
                borderWidth: 1,
                borderDash: [5, 5],
                pointRadius: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            },
            scales: {
                r: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        stepSize: 20
                    }
                }
            }
        }
    });
}

// Concurrency Patterns Chart
function createConcurrencyChart() {
    const ctx = document.getElementById('concurrencyChart');
    if (!ctx) return;
    
    const concurrencyData = {{if .Report.Patterns.ConcurrencyPatterns}}{
        goroutines: {{.Report.Patterns.ConcurrencyPatterns.Goroutines.TotalCount}},
        channels: {{.Report.Patterns.ConcurrencyPatterns.Channels.TotalCount}},
        workerPools: {{len .Report.Patterns.ConcurrencyPatterns.WorkerPools}},
        pipelines: {{len .Report.Patterns.ConcurrencyPatterns.Pipelines}},
        semaphores: {{len .Report.Patterns.ConcurrencyPatterns.Semaphores}},
        fanOut: {{len .Report.Patterns.ConcurrencyPatterns.FanOut}},
        fanIn: {{len .Report.Patterns.ConcurrencyPatterns.FanIn}}
    }{{else}}{
        goroutines: 0, channels: 0, workerPools: 0, pipelines: 0, semaphores: 0, fanOut: 0, fanIn: 0
    }{{end}};
    
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Goroutines', 'Channels', 'Worker Pools', 'Pipelines', 'Semaphores', 'Fan-Out', 'Fan-In'],
            datasets: [{
                label: 'Count',
                data: Object.values(concurrencyData),
                backgroundColor: [
                    '#667eea',
                    '#764ba2',
                    '#f093fb',
                    '#f5576c',
                    '#4facfe',
                    '#00f2fe',
                    '#43e97b'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        stepSize: 1
                    }
                }
            }
        }
    });
}

// Modal functionality
function initializeModal() {
    const modal = document.getElementById('functionModal');
    const closeBtn = modal.querySelector('.close');
    
    closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
    });
    
    window.addEventListener('click', (event) => {
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });
}

// Show function details in modal
function showFunctionDetails(functionName) {
    const modal = document.getElementById('functionModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');
    
    // Find function data from table
    const rows = document.querySelectorAll('#functionsTable tbody tr');
    const functionRow = Array.from(rows).find(row => 
        row.cells[0].textContent === functionName
    );
    
    if (functionRow) {
        const details = {
            name: functionRow.cells[0].textContent,
            package: functionRow.cells[1].textContent,
            lines: functionRow.cells[2].textContent,
            complexity: functionRow.cells[3].textContent,
            parameters: functionRow.cells[4].textContent,
            returns: functionRow.cells[5].textContent
        };
        
        modalTitle.textContent = 'Function: ' + details.name;
        modalBody.innerHTML = 
            '<div class="function-details">' +
                '<p><strong>Package:</strong> ' + details.package + '</p>' +
                '<p><strong>Lines of Code:</strong> ' + details.lines + '</p>' +
                '<p><strong>Cyclomatic Complexity:</strong> ' + details.complexity + '</p>' +
                '<p><strong>Parameters:</strong> ' + details.parameters + '</p>' +
                '<p><strong>Return Values:</strong> ' + details.returns + '</p>' +
                '<h3>Complexity Analysis</h3>' +
                '<div class="complexity-analysis">' + getComplexityAnalysis(parseInt(details.complexity)) + '</div>' +
                '<h3>Recommendations</h3>' +
                '<div class="recommendations">' + getRecommendations(details) + '</div>' +
            '</div>';
        
        modal.style.display = 'block';
    }
}

function getComplexityAnalysis(complexity) {
    if (complexity <= 5) {
        return '<span class="badge success">Low complexity - Easy to understand and maintain</span>';
    } else if (complexity <= 10) {
        return '<span class="badge warning">Medium complexity - Consider refactoring if possible</span>';
    } else {
        return '<span class="badge danger">High complexity - Should be refactored for better maintainability</span>';
    }
}

function getRecommendations(details) {
    const recommendations = [];
    
    if (parseInt(details.complexity) > 10) {
        recommendations.push('• Consider breaking this function into smaller, more focused functions');
        recommendations.push('• Look for opportunities to extract common patterns');
    }
    
    if (parseInt(details.lines) > 50) {
        recommendations.push('• Function is quite long - consider splitting into multiple functions');
    }
    
    if (parseInt(details.parameters) > 5) {
        recommendations.push('• Consider using a struct to group related parameters');
    }
    
    if (recommendations.length === 0) {
        recommendations.push('• Function looks well-structured');
        recommendations.push('• Consider adding unit tests if not already present');
    }
    
    return recommendations.join('<br>');
}
{{end}}
</html>

{{define "styles"}}
/* Enhanced responsive design with interactive features */
:root {
    --primary-color: #007bff;
    --success-color: #28a745;
    --warning-color: #ffc107;
    --danger-color: #dc3545;
    --info-color: #17a2b8;
    --light-color: #f8f9fa;
    --dark-color: #343a40;
    --border-radius: 8px;
    --box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    --transition: all 0.3s ease;
}

* {
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.6;
    margin: 0;
    padding: 0;
    background-color: var(--light-color);
    color: var(--dark-color);
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
}

/* Header Styles */
header {
    background: white;
    padding: 30px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 30px;
}

header h1 {
    margin: 0 0 20px 0;
    color: var(--primary-color);
    font-size: 2.5rem;
    font-weight: 600;
}

.metadata {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    margin-top: 20px;
}

.metadata p {
    margin: 0;
    padding: 10px;
    background: var(--light-color);
    border-radius: 4px;
}

/* Navigation Tabs */
.nav-tabs {
    display: flex;
    background: white;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 30px;
    overflow-x: auto;
}

.nav-tab {
    flex: 1;
    padding: 15px 20px;
    border: none;
    background: transparent;
    cursor: pointer;
    font-size: 16px;
    font-weight: 500;
    color: #6c757d;
    transition: var(--transition);
    white-space: nowrap;
}

.nav-tab:hover {
    background-color: var(--light-color);
    color: var(--primary-color);
}

.nav-tab.active {
    background-color: var(--primary-color);
    color: white;
}

.nav-tab:first-child {
    border-top-left-radius: var(--border-radius);
    border-bottom-left-radius: var(--border-radius);
}

.nav-tab:last-child {
    border-top-right-radius: var(--border-radius);
    border-bottom-right-radius: var(--border-radius);
}

/* Tab Content */
.tab-content {
    display: none;
    background: white;
    padding: 30px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 30px;
}

.tab-content.active {
    display: block;
}

.tab-content h2 {
    margin: 0 0 30px 0;
    color: var(--dark-color);
    font-size: 2rem;
}

/* Metrics Grid */
.metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
}

.metric-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 25px;
    border-radius: var(--border-radius);
    text-align: center;
    position: relative;
    overflow: hidden;
}

.metric-card::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
    transform: rotate(45deg);
    transition: var(--transition);
}

.metric-card:hover::before {
    animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
    100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

.metric-card h3 {
    font-size: 2.5rem;
    margin: 0 0 10px 0;
    font-weight: 700;
}

.metric-card p {
    margin: 0 0 15px 0;
    font-size: 1.1rem;
    opacity: 0.9;
}

.metric-trend {
    position: absolute;
    top: 10px;
    right: 15px;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
}

.metric-trend.positive {
    background: rgba(40, 167, 69, 0.8);
}

.metric-trend.negative {
    background: rgba(220, 53, 69, 0.8);
}

.metric-trend.neutral {
    background: rgba(108, 117, 125, 0.8);
}

/* Charts Grid */
.charts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 30px;
    margin-bottom: 40px;
}

.chart-container {
    background: white;
    padding: 25px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
}

.chart-container h3 {
    margin: 0 0 20px 0;
    text-align: center;
    color: var(--dark-color);
}

.chart-container canvas {
    max-height: 300px;
}

/* Filters */
.filters {
    display: flex;
    gap: 15px;
    margin-bottom: 25px;
    flex-wrap: wrap;
}

.filters input,
.filters select {
    padding: 10px 15px;
    border: 2px solid #e9ecef;
    border-radius: var(--border-radius);
    font-size: 14px;
    min-width: 200px;
    transition: var(--transition);
}

.filters input:focus,
.filters select:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
}

/* Tables */
.table-container {
    overflow-x: auto;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    margin: 0;
}

.data-table th {
    background: var(--primary-color);
    color: white;
    padding: 15px 12px;
    text-align: left;
    font-weight: 600;
    cursor: pointer;
    user-select: none;
    position: sticky;
    top: 0;
    z-index: 10;
}

.data-table th:hover {
    background: #0056b3;
}

.data-table .sort-icon {
    margin-left: 8px;
    opacity: 0.7;
}

.data-table td {
    padding: 12px;
    border-bottom: 1px solid #e9ecef;
    transition: var(--transition);
}

.data-table tr:hover {
    background-color: rgba(0, 123, 255, 0.05);
}

.data-table tr:nth-child(even) {
    background-color: #f8f9fa;
}

.data-table tr:nth-child(even):hover {
    background-color: rgba(0, 123, 255, 0.05);
}

.complexity-cell.low {
    color: var(--success-color);
    font-weight: 600;
}

.complexity-cell.medium {
    color: var(--warning-color);
    font-weight: 600;
}

.complexity-cell.high {
    color: var(--danger-color);
    font-weight: 600;
}

.function-name {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-weight: 600;
}

/* Buttons */
.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: var(--transition);
    background: var(--primary-color);
    color: white;
}

.btn:hover {
    background: #0056b3;
    transform: translateY(-1px);
}

.btn.btn-sm {
    padding: 6px 12px;
    font-size: 12px;
}

/* Concurrency Grid */
.concurrency-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.concurrency-card {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    padding: 20px;
    border-radius: var(--border-radius);
    text-align: center;
}

.concurrency-card h3 {
    font-size: 2rem;
    margin: 0 0 10px 0;
}

.concurrency-card p {
    margin: 0;
    opacity: 0.9;
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.modal-content {
    background-color: white;
    margin: 5% auto;
    padding: 30px;
    border-radius: var(--border-radius);
    width: 90%;
    max-width: 800px;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from { transform: translateY(-50px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

.close {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    color: #aaa;
}

.close:hover {
    color: #000;
}

/* Responsive Design */
@media (max-width: 768px) {
    .container {
        padding: 10px;
    }
    
    header h1 {
        font-size: 2rem;
    }
    
    .metadata {
        grid-template-columns: 1fr;
    }
    
    .nav-tabs {
        flex-direction: column;
    }
    
    .nav-tab {
        border-radius: 0 !important;
    }
    
    .metrics-grid {
        grid-template-columns: 1fr;
    }
    
    .charts-grid {
        grid-template-columns: 1fr;
    }
    
    .filters {
        flex-direction: column;
    }
    
    .filters input,
    .filters select {
        min-width: 100%;
    }
    
    .table-container {
        font-size: 14px;
    }
    
    .data-table th,
    .data-table td {
        padding: 8px 6px;
    }
    
    .modal-content {
        margin: 10% auto;
        width: 95%;
        padding: 20px;
    }
}

@media (max-width: 480px) {
    header h1 {
        font-size: 1.5rem;
    }
    
    .metric-card h3 {
        font-size: 2rem;
    }
    
    .concurrency-card h3 {
        font-size: 1.5rem;
    }
}

/* Print Styles */
@media print {
    .nav-tabs,
    .filters,
    .btn {
        display: none !important;
    }
    
    .tab-content {
        display: block !important;
        page-break-inside: avoid;
    }
    
    .chart-container {
        page-break-inside: avoid;
    }
}
{{end}}
}

header h1 {
    margin: 0 0 20px 0;
    color: #2c3e50;
    font-size: 2.5em;
}

.metadata p {
    margin: 5px 0;
    color: #6c757d;
}

section {
    background: white;
    margin-bottom: 30px;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

section h2 {
    margin: 0 0 20px 0;
    color: #2c3e50;
    border-bottom: 3px solid #3498db;
    padding-bottom: 10px;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
}

.stat-card {
    text-align: center;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e9ecef;
}

.stat-card h3 {
    font-size: 2em;
    margin: 0 0 10px 0;
    color: #3498db;
}

.stat-card p {
    margin: 0;
    color: #6c757d;
    font-weight: 500;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

.data-table th,
.data-table td {
    text-align: left;
    padding: 12px 15px;
    border-bottom: 1px solid #e9ecef;
}

.data-table th {
    background: #f8f9fa;
    font-weight: 600;
    color: #2c3e50;
}

.data-table tbody tr:hover {
    background: #f8f9fa;
}
